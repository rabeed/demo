<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:jsf="http://xmlns.jcp.org/jsf">
<h:head>
	<meta charset="UTF-8" />
	<title>JEE7 Starter</title>

	<h:outputScript library="jquery-2.2.1" name="jquery.js" />
	<h:outputScript library="bootstrap-3.3.6" name="/js/bootstrap.js" />
	<ui:insert name="customScripts" />

	<h:outputStylesheet library="bootstrap-3.3.6"
		name="/css/bootstrap-jsf.css" />
	<ui:insert name="customStylesheets" />
</h:head>
<h:body>


	<ui:composition template="templates/template.xhtml">
		<ui:define name="panel-top" >
			<section  jsf:id="panel-top-section">

				<h1>Shopping Cart</h1>
				<ui:fragment rendered="#{shoppingCart.total==0}">
					<p>your shoopingcart is empty.</p>
				</ui:fragment>
				<ui:fragment rendered="#{shoppingCart.total==1}">
					<p>your shoopingcart contains one item.</p>
				</ui:fragment>
				<ui:fragment rendered="#{shoppingCart.total>1}">
					<p>your shoopingcart contains #{shoppingCart.total} itmes</p>
					<h:outputLink value="index.xhtml">back to products</h:outputLink>
				</ui:fragment>
				You have #{shoppingCart.totalAllItems} items in your shoppingCart.
			</section>
		</ui:define>

		<ui:define name="pageContent">
		
			<h:form>
				<ui:fragment rendered="#{not empty shoppingCart.lines}">
					<section>					
							<h:dataTable var="l" value="#{shoppingCart.lines}">
								<h:column>
									<f:facet name="header">Products</f:facet>
									<h:outputLink value="product-details.xhtml">
										<f:param name="id" value="#{l.product.id}" />
									#{l.product.name}
									</h:outputLink>
								</h:column>
								<h:column>
									<f:facet name="header">price</f:facet>
									#{l.product.price}
								</h:column>
								<h:column>
									<f:facet name="header">quantity</f:facet>
									#{l.quantity}
									<h:commandButton action="#{shoppingCart.addMoreItems(l.product)}" value="+">
											<f:ajax render="@form panel-top-section"/> 
									</h:commandButton>
									<h:commandButton	action="#{shoppingCart.removeProduct(l.product)}" value="-">
										<f:ajax render="@form panel-top-section"/> 
									</h:commandButton>
								</h:column>
								<h:column>
									<f:facet name="header">amount</f:facet>
									#{l.amount}
									<f:facet name="footer">	#{shoppingCart.totalAmount}</f:facet>
								</h:column>

							</h:dataTable>
							<h:commandButton value="proceed to check out" action="checkout"
								styleClass="button-right" />
						
					</section>
				</ui:fragment>
				</h:form>
			
		</ui:define>
	</ui:composition>

</h:body>
</html>
